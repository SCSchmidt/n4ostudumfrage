---
title: "Evaluation of the NFDI4Objects survey for students and trainees"
author:
  - Sophie C. Schmidt:
      email: sophie.schmidt@dainst.de
      institute: [DAI]
      correspondence: true
  - Christin Keller:
      email: christin.keller@dainst.de
      institute: [DAI]
      correspondence: false
  - Louise Rokohl:
      email: rokohl@rgzm.de
      institute: [RGZM]
      correspondence: false
  - Florian Thiery:
      email: thiery@rgzm.de
      institute: [RGZM]
      correspondence: false
  - Henrike Backhaus:
      email: henrike.backhaus@hs-mainz.de
      institute: [HSM]
      correspondence: false 
institute:
  - DAI: Deutsches Archäologisches Institut
  - RGZM: Römisch-Germanisches Zentralmuseum Mainz
  - HSM: Hochschule Mainz
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::word_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
bibliography: references.bib
csl: "../templates/journal-of-archaeological-science.csl" # Insert path for the bib-style
abstract: |
  Text of abstract
keywords: |
  NFDI, survey, results, research data management
highlights: |
  These are the highlights. 
---

<!-- This is the format for text comments that will be ignored during renderings. Do not put R code in these comments because it will not be ignored. -->

<!-- With the following code you can access and display values from the yml header above. -->

Keywords: `r rmarkdown::metadata$keywords`

Highlights: `r rmarkdown::metadata$highlights`

<!-- The following code chunk defines some general settings how code chunks should behave. -->

```{r setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>",
  fig.path = "../figures/",
  dpi = 300
)
```

<!-- The actual document text starts here: -->

# Introduction
This paper gives a quick overview over the results of the NFDI4Objects survey, that was tailored to students and trainees.

We were especially interested in what kind of courses on research data management or related topics have been offered to students and trainees and how they gathered the skills they need for their work.

# data set

```{r data}

d <- read.csv2("../data/raw_data/20201210_results-survey553894.csv", sep = ",")

library(tidyr)
library(dplyr)
library(tidyverse)

d <- d %>%
  rename(Archaeologie = studienfach.SQ001.,
        Anthropologie = studienfach.SQ002.,
        Archaeozoologie =  studienfach.SQ003.,
        Archaeobotanik =  studienfach.SQ004.,
        Architektur.Bauforschung =  studienfach.SQ005.,
        Digital.Humanities = studienfach.SQ006.,
        Geschichtswissenschaften = studienfach.SQ007.,
        Grabungstechnik = studienfach.SQ008.,
        Klimaforschung = studienfach.SQ009.,
        Konservierung = studienfach.SQ010.,
        Kunstgeschichte =  studienfach.SQ011.,
        Linguistik.Philologie = studienfach.SQ012.,
        MINT = studienfach.SQ013.,
        Museumswissenschaften = studienfach.SQ014.,
        Musikwissenschaften = studienfach.SQ015.,
        Geochemie = studienfach.SQ016.,
        Geologie = studienfach.SQ017.,
        Geographie = studienfach.SQ018.,
        Restaurierung = studienfach.SQ019.)

```


how many respondents: in total `r nrow(d)` number of answers

## demographics of respondents

### age

```{r age}
library(ggplot2)

sum_alter  <- summary(d$alter)

ggplot(data = d)+
  geom_histogram(aes(x = alter), binwidth = 1)+
  xlab("age")+
  geom_text(aes(x = 65, y = 20, label = paste("n =", nrow(d))))+
  geom_text(aes(x = 65, y = 10, label = paste("NA's = ", sum_alter[7])))



```

Most of the respondents are aged between `r sum_alter[2]` (first quartile) and `r sum_alter[5]` (third quartile) years old. The youngest person is `r sum_alter[1]` and the oldest `r sum_alter[6]`. Median age is `r sum_alter[3]` and mean age is `r sum_alter[4]`. We can therfore conclude that we were able to reach the group of 20-29 year olds which was our aim. 

### type of training


```{r training}

ggplot(data = d, aes(x = artausbildung, fill = artausbildung))+
  geom_bar()+
  geom_text(stat='count', aes(label = after_stat(count)), hjust=-0.01)+
  labs(x = "type of training")+
  guides(fill = FALSE)+
  coord_flip()
```

### subject of studies

```{r, faecher}


faecher <-  d %>%
  pivot_longer(c(Archaeologie:Restaurierung),
             names_to = "fach",
             values_to = "ja") %>%
  filter(ja == "Ja")

tab_fach <- as.data.frame(table(faecher$fach))


  # text mining "sonstige" für Fächer
  
library("tm")
library("SnowballC")

  # bwl und betriebswirtschaftslehre zusammenfügen, bibliotheks und informationswissenschaft, journalisitik und journalismus zusammenfügen
d$studienfach.other.  <- gsub("bwl", "betriebswirtschaftslehre", d$studienfach.other.)
d$studienfach.other.  <- gsub("bibliotheks", "bibliothekswissenschaften", d$studienfach.other.)
d$studienfach.other.  <- gsub("journalistik", "journalismus", d$studienfach.other.)

docs <- Corpus(VectorSource(d$studienfach.other.))

#inspect(docs)

# Remove punctuations
#docs <- tm_map(docs, removePunctuation)

# Eliminate extra white spaces
docs <- tm_map(docs, stripWhitespace)

# Text stemming
# docs <- tm_map(docs, stemDocument)
docs <- tm_map(docs, removeWords, stopwords("german"))

# Document matrix is a table containing the frequency of the words. 
# Column names are words and row names are documents. 
# The function TermDocumentMatrix() from text mining package can be used as follow :
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
studienfach_sonst <- data.frame(word = names(v),freq=v)
head(studienfach_sonst, 30)

## to do! 
# soziale arbeit wieder zusammenfügen,
# informatik zu mint, archäoinformatik zu DH?
# antike kulturen vorderasiens und ägyptens?

# bauforschung?

colnames(studienfach_sonst)  <- c("Var1", "Freq")

studfach_alle  <- rbind(tab_fach, studienfach_sonst)

studfach_alle <- studfach_alle[!studfach_alle$Var1 == "arbeit",]
#studfach_alle$Var1[studfach_alle$Var1 == "soziale"] <- "soziale arbeit"
studfach_alle <- studfach_alle[!studfach_alle$Var1 == "relations",]

studfach_alle$Var1 <- recode(studfach_alle$Var1,
                                      soziale = "Soziale Arbeit",
                             public = "public relations")



studfach_alle %>%
  filter(Freq > 2) %>%
  ggplot()+
  geom_bar(aes(x = reorder(Var1, Freq), y = Freq), stat = "identity")+
  labs(x = "subjects", 
       y = "frequency (> 2)", 
       name = "Main subject of respondent")+
    coord_flip()

```


# which year of studies

```{r ausbildung}

ggplot(data = d)+
  geom_histogram(aes(x = jahrausbildung, fill =  artausbildung, col = artausbildung), alpha = 0.3)

```


### gender

```{r gender}

gender <- as.data.frame(table(d$geschlecht))
gender$Freq[gender$Var1 == "keine Angabe"] <- gender$Freq[gender$Var1 == "keine Angabe"] + gender$Freq[gender$Var1 == ""]
gender <- gender[-(gender$Var1 == ""),]

ggplot(data = gender, aes(x = reorder(Var1, -Freq), y = Freq))+
  geom_bar(stat = "identity" )+
    labs(x = "gender", 
       y = "frequency", 
       name = "Gender of respondent")+
    geom_text(aes(label = Freq), hjust = 0.5)+
theme_bw()
```

### institution

```{r inst}

inst  <- as.data.frame(table(d$institution))

inst$Var1[inst$Var1 == ""] <- NA

ggplot(data = inst, aes(x = reorder(Var1, -Freq), y = Freq))+
  geom_bar(stat = "identity")+    
  geom_text(aes(label = Freq), hjust = 0.5)+
  coord_flip()


```



\newpage

# References 

<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->

<div id="refs"></div>

\newpage

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
if ("devtools" %in% installed.packages()) devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? 
if ("git2r" %in% installed.packages() & git2r::in_repository(path = ".")) git2r::repository(here::here())  
```
